<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;300;400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Montserrat", sans-serif;
        background: #000;
        overflow-x: hidden;
      }

      .container2 {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0;
      }

      .content {
        width: 100%;
        height: 100%;
      }

      #universe {
        width: 100%;
        height: 100%;
      }

      .title {
        position: relative;
        z-index: 2;
        text-align: center;
        padding: 50px 20px;
        color: white;
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
      }

      .STARDUST1 {
        font-size: 1.5rem;
        font-weight: 300;
        margin-bottom: 10px;
      }

      .STARDUST2 {
        font-size: 3rem;
        font-weight: 600;
        margin-bottom: 15px;
      }

      .STARDUST3 {
        font-size: 1.2rem;
        font-weight: 400;
        margin-bottom: 30px;
      }

      .img {
        max-width: 300px;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        margin-bottom: 30px;
      }

      /* Photo Slider */
      .photo-slider {
        position: relative;
        z-index: 2;
        width: 90%;
        max-width: 1000px;
        margin: 50px auto;
        overflow: hidden;
        padding: 20px;
      }

      .slider-track {
        display: flex;
        transition: transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        gap: 20px;
      }

      .slider-item {
        max-height: 100%;
        min-width: calc(33.333% - 14px);
        flex-shrink: 0;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        transition: transform 0.3s ease;
        cursor: grab;
      }

      .slider-item:active {
        cursor: grabbing;
      }

      .slider-item:hover {
        transform: translateY(-10px);
      }

      .slider-item img {
        width: 100%;
        height: 300px;
        object-fit: cover;
        display: block;
      }

      .slider-controls {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-top: 30px;
      }

      .slider-btn {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        border: none;
        background: rgba(255, 255, 255, 0.2);
        color: white;
        font-size: 24px;
        cursor: pointer;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
      }

      .slider-btn:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: scale(1.1);
      }

      /* Image Popup */
      .image-popup {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        z-index: 9999;
        display: none;
        justify-content: center;
        align-items: center;
        opacity: 0;
        transition: opacity 0.3s ease;
      }

      .image-popup.active {
        display: flex;
        opacity: 1;
      }

      .popup-content {
        position: relative;
        max-width: 90%;
        max-height: 90%;
        animation: zoomIn 0.3s ease;
      }

      @keyframes zoomIn {
        from {
          transform: scale(0.8);
          opacity: 0;
        }
        to {
          transform: scale(1);
          opacity: 1;
        }
      }

      .popup-content img {
        max-width: 100%;
        max-height: 90vh;
        object-fit: contain;
        border-radius: 10px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
      }

      .popup-close {
        position: absolute;
        top: -50px;
        right: 0;
        width: 40px;
        height: 40px;
        background: rgba(255, 255, 255, 0.2);
        border: none;
        border-radius: 50%;
        color: white;
        font-size: 24px;
        cursor: pointer;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .popup-close:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: rotate(90deg);
      }

      @media (max-width: 1024px) {
        .slider-item {
          min-width: calc(50% - 10px);
        }
      }

      @media (max-width: 768px) {
        .STARDUST2 {
          font-size: 2rem;
        }

        .slider-item {
          min-width: 100%;
        }

        .slider-item img {
          height: 250px;
        }

        .popup-close {
          top: 10px;
          right: 10px;
        }
      }
    </style>
  </head>

  <body>
    <div class="container2">
      <div class="content">
        <canvas id="universe"></canvas>
      </div>
    </div>

    <div class="title">
      <h3 class="STARDUST1">31-10-2024</h3>
      <h1 class="STARDUST2">KEM &amp; ĐÚNG</h1>
      <h3 class="STARDUST3">
        I <strong>❤</strong> L O V E <strong>❤</strong> Y O U
      </h3>
    </div>

    <!-- Photo Slider -->
    <div class="photo-slider">
      <div class="slider-track" id="sliderTrack">
        <div class="slider-item">
          <img src="./images/1.png" alt="Memory 1" />
        </div>
        <div class="slider-item">
          <img src="./images/2.png" alt="Memory 2" />
        </div>
        <div class="slider-item">
          <img src="./images/3.png" alt="Memory 3" />
        </div>
      </div>

      <div class="slider-controls">
        <button class="slider-btn" id="prevSlider">‹</button>
        <button class="slider-btn" id="nextSlider">›</button>
      </div>
    </div>

    <!-- Image Popup -->
    <div class="image-popup" id="imagePopup">
      <div class="popup-content">
        <button class="popup-close" id="popupClose">×</button>
        <img id="popupImage" src="" alt="Full size image" />
      </div>
    </div>

    <script src="js/particle.js"></script>

    <script>
      // Universe Canvas Animation (Nền sao rơi)
      const canvas = document.getElementById("universe");
      const ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      const stars = [];
      for (let i = 0; i < 200; i++) {
        stars.push({
          x: Math.random() * canvas.width,
          y: Math.random() * canvas.height,
          radius: Math.random() * 2,
          speed: Math.random() * 0.5 + 0.1,
        });
      }

      function animateStars() {
        ctx.fillStyle = "rgba(0, 0, 0, 0.1)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.fillStyle = "white";
        stars.forEach((star) => {
          ctx.beginPath();
          ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
          ctx.fill();

          star.y += star.speed;
          if (star.y > canvas.height) {
            star.y = 0;
            star.x = Math.random() * canvas.width;
          }
        });

        requestAnimationFrame(animateStars);
      }
      animateStars();

      window.addEventListener("resize", () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      });

      // Smooth Photo Slider
      const sliderTrack = document.getElementById("sliderTrack");
      const sliderItems = document.querySelectorAll(".slider-item");
      const prevBtn = document.getElementById("prevSlider");
      const nextBtn = document.getElementById("nextSlider");

      let currentIndex = 0;
      let itemsPerView = 3;
      let startX = 0;
      let isDragging = false;
      let currentTranslate = 0;
      let prevTranslate = 0;

      function updateItemsPerView() {
        if (window.innerWidth <= 768) {
          itemsPerView = 1;
        } else if (window.innerWidth <= 1024) {
          itemsPerView = 2;
        } else {
          itemsPerView = 3;
        }
      }

      updateItemsPerView();
      window.addEventListener("resize", updateItemsPerView);

      const totalSlides = Math.ceil(sliderItems.length / itemsPerView);

      function updateSlider() {
        const itemWidth = sliderItems[0].offsetWidth;
        const gap = 20;
        const offset = currentIndex * (itemWidth + gap) * itemsPerView;
        sliderTrack.style.transform = `translateX(-${offset}px)`;
      }

      function nextSlide() {
        if (currentIndex < totalSlides - 1) {
          currentIndex++;
          updateSlider();
        }
      }

      function prevSlide() {
        if (currentIndex > 0) {
          currentIndex--;
          updateSlider();
        }
      }

      // Touch & Mouse Drag
      sliderTrack.addEventListener("mousedown", dragStart);
      sliderTrack.addEventListener("touchstart", dragStart);
      sliderTrack.addEventListener("mousemove", drag);
      sliderTrack.addEventListener("touchmove", drag);
      sliderTrack.addEventListener("mouseup", dragEnd);
      sliderTrack.addEventListener("touchend", dragEnd);
      sliderTrack.addEventListener("mouseleave", dragEnd);

      function dragStart(e) {
        isDragging = true;
        startX = e.type.includes("mouse") ? e.pageX : e.touches[0].clientX;
        sliderTrack.style.transition = "none";
      }

      function drag(e) {
        if (!isDragging) return;
        e.preventDefault();

        const currentX = e.type.includes("mouse")
          ? e.pageX
          : e.touches[0].clientX;
        const diff = currentX - startX;
        currentTranslate = prevTranslate + diff;

        sliderTrack.style.transform = `translateX(${currentTranslate}px)`;
      }

      function dragEnd() {
        if (!isDragging) return;
        isDragging = false;

        sliderTrack.style.transition =
          "transform 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)";

        const movedBy = currentTranslate - prevTranslate;

        if (movedBy < -100 && currentIndex < totalSlides - 1) {
          nextSlide();
        } else if (movedBy > 100 && currentIndex > 0) {
          prevSlide();
        } else {
          updateSlider();
        }

        const itemWidth = sliderItems[0].offsetWidth;
        const gap = 20;
        prevTranslate = -currentIndex * (itemWidth + gap) * itemsPerView;
      }

      prevBtn.addEventListener("click", prevSlide);
      nextBtn.addEventListener("click", nextSlide);

      window.addEventListener("resize", () => {
        updateSlider();
        const itemWidth = sliderItems[0].offsetWidth;
        const gap = 20;
        prevTranslate = -currentIndex * (itemWidth + gap) * itemsPerView;
      });

      // Image Popup
      const imagePopup = document.getElementById("imagePopup");
      const popupImage = document.getElementById("popupImage");
      const popupClose = document.getElementById("popupClose");

      // Click vào ảnh để xem full
      sliderItems.forEach((item) => {
        item.addEventListener("click", function (e) {
          if (!isDragging) {
            const img = this.querySelector("img");
            popupImage.src = img.src;
            imagePopup.classList.add("active");
            document.body.style.overflow = "hidden";
          }
        });
      });

      // Đóng popup
      popupClose.addEventListener("click", () => {
        imagePopup.classList.remove("active");
        document.body.style.overflow = "";
      });

      // Click ra ngoài để đóng
      imagePopup.addEventListener("click", (e) => {
        if (e.target === imagePopup) {
          imagePopup.classList.remove("active");
          document.body.style.overflow = "";
        }
      });

      // Phím ESC để đóng
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && imagePopup.classList.contains("active")) {
          imagePopup.classList.remove("active");
          document.body.style.overflow = "";
        }
      });
    </script>
  </body>
</html>
